webpackJsonp([10],{Bft5:function(t,e){},dLxA:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s={props:{goods:{type:[Array,Object],default:function(){return[]}},delivery:{type:Boolean,default:function(){return!1}}},computed:{checked:{get:function(){var t=[];for(var e in this.goods)t.push(this.goods[e].id);return t},set:function(t){this.$emit("checked",t)}}}},r={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"afterservicelist"},[i("yd-checklist",{attrs:{label:!0,color:"#ff3b44"},model:{value:t.checked,callback:function(e){t.checked=e},expression:"checked"}},t._l(t.goods,function(e,s){return i("yd-checklist-item",{key:s,attrs:{val:e.id,disabled:!t.delivery}},[i("yd-flexbox",{staticStyle:{padding:".2rem 0"}},[i("img",{staticClass:"goodsimg",attrs:{src:e.image_url}}),t._v(" "),i("yd-flexbox-item",{attrs:{align:"top"}},[i("h3",{staticClass:"goodsname"},[t._v(t._s(e.name))]),t._v(" "),i("p",{staticClass:"standard"},[t._v(t._s(e.addon))])])],1)],1)}))],1)},staticRenderFns:[]},a=i("VU/8")(s,r,!1,null,null,null).exports,n={data:function(){return{radio:"1",custPrice:""}},props:{delivery:{type:Boolean,default:function(){return!0}},price:{type:[String,Number],default:function(){return""}}},watch:{radio:function(){this.$emit("type",this.radio)},custPrice:function(){this.$emit("custPrice",this.custPrice)}}},o={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("yd-cell-group",[i("yd-cell-item",[i("span",{attrs:{slot:"left"},slot:"left"},[t._v("商品价格")]),t._v(" "),i("span",{attrs:{slot:"right"},slot:"right"},[i("yd-radio-group",{attrs:{color:"#ff3b44"},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[i("yd-radio",{attrs:{val:"1"}},[t._v("仅退款")]),t._v(" "),t.delivery?i("yd-radio",{attrs:{val:"2"}},[t._v("退货退款")]):i("yd-radio",{attrs:{val:"2",disabled:""}},[t._v("退货退款")])],1)],1)]),t._v(" "),i("yd-cell-item",[i("span",{attrs:{slot:"left"},slot:"left"},[t._v("退款金额")]),t._v(" "),"1"===t.radio?i("span",{attrs:{slot:"right"},slot:"right"},[t._v(t._s(t.price)+"元")]):"2"===t.radio?i("yd-input",{attrs:{slot:"right",type:"number",placeholder:"请输入退款金额"},slot:"right",model:{value:t.custPrice,callback:function(e){t.custPrice=e},expression:"custPrice"}}):t._e()],1)],1)},staticRenderFns:[]},c={data:function(){return{imgs:[],upload:!0,imgData:{accept:"image/gif, image/jpeg, image/png, image/jpg"}}},methods:{uploadImg:function(t){var e=this,i=t.target.files[0],s=new FormData;s.append("upfile",i,i.name),this.$api.uploadFile("image",s,function(t){t.status&&e.imgs.push(t.data)})},remove:function(t){this.imgs.splice(t,1)}},watch:{imgs:function(){this.$emit("images",this.imgs),this.imgs.length>=4?this.upload=!1:this.upload=!0}}},l={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"afterserviceimg"},[t.imgs.length?s("div",{staticClass:"uploadimg-list"},t._l(t.imgs,function(e,i){return s("div",{key:i},[s("yd-badge",{nativeOn:{click:function(e){t.remove(i)}}},[t._v("X")]),t._v(" "),s("img",{staticClass:"thumbnail-list",attrs:{src:e.url}})],1)})):t._e(),t._v(" "),s("div",{staticClass:"uploadimg"},[s("input",{attrs:{name:"file",type:"file",accept:"image/png,image/gif,image/jpeg"},on:{change:t.uploadImg}}),t._v(" "),s("img",{directives:[{name:"show",rawName:"v-show",value:t.upload,expression:"upload"}],attrs:{slot:"icon",src:i("jd4r")},slot:"icon"})])])},staticRenderFns:[]},d={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"afterservicetext"},[i("yd-cell-group",{attrs:{title:"问题描述"}},[i("yd-cell-item",[i("yd-textarea",{attrs:{slot:"right",placeholder:"请您在此描述您的问题",maxlength:"100"},slot:"right",model:{value:t.reason,callback:function(e){t.reason=e},expression:"reason"}})],1)],1)],1)},staticRenderFns:[]};var u={components:{afterservicelist:a,afterservicecell:i("VU/8")(n,o,!1,null,null,null).exports,afterserviceimg:i("VU/8")(c,l,!1,null,null,null).exports,afterservicetext:i("VU/8")({data:function(){return{reason:""}},watch:{reason:function(){this.$emit("reason",this.reason)}}},d,!1,function(t){i("Bft5")},null,null).exports},data:function(){return{order_id:this.$route.query.order_id||0,is_delivery:!0,goodsList:[],type:1,img_id:[],items:[],reasonMsg:"",afterPrice:""}},created:function(){var t=this;if(!this.order_id)return this.$dialog.alert({mes:"订单不存在"}),!1;this.$api.afterSalesStatus({order_id:this.order_id},function(e){if(e.status){var i=e.data.text_status;if("pending_payment"!==i&&"completed"!==i&&"cancel"!==i)for(var s in"pending_delivery"===i&&(t.is_delivery=!1),t.goodsList=e.data.items,t.afterPrice=e.data.payed-e.data.refunded,t.goodsList)t.items=t.items.concat({id:t.goodsList[s].id,nums:t.goodsList[s].nums});else t.$dialog.alert({mes:"该订单状态不可申请售后",callback:function(){t.$router.go(-1)}})}else t.$dialog.alert({mes:"该订单不存在",callback:function(){t.$router.go(-1)}})})},methods:{checked:function(t){var e=[];for(var i in t)for(var s in this.goodsList)t[i]===this.goodsList[s].id&&e.push({id:this.goodsList[s].id,nums:this.goodsList[s].nums});this.items=e},images:function(t){for(var e in t)-1===this.img_id.indexOf(t[e].image_id)&&this.img_id.push(t[e].image_id)},reason:function(t){this.reasonMsg=t},custPrice:function(t){this.afterPrice=t},afterType:function(t){this.type=t},formSubmit:function(){var t=this;this.$api.addAfterSales({order_id:this.order_id,type:this.type,images:this.img_id,items:this.items,refund:this.afterPrice,reason:this.reasonMsg},function(e){e.status&&t.$dialog.toast({mes:"提交成功",time:1500,icon:"success"})})}}},f={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"afterservice"},[i("afterservicelist",{attrs:{goods:t.goodsList,delivery:t.is_delivery},on:{checked:t.checked}}),t._v(" "),i("afterservicecell",{attrs:{delivery:t.is_delivery,price:t.afterPrice},on:{type:t.afterType,custPrice:t.custPrice}}),t._v(" "),i("afterserviceimg",{on:{images:t.images}}),t._v(" "),i("afterservicetext",{on:{reason:t.reason}}),t._v(" "),i("yd-button-group",[i("yd-button",{attrs:{size:"large",bgcolor:"#ff3b44",color:"#fff"},nativeOn:{click:function(e){return t.formSubmit(e)}}},[t._v("提交")])],1)],1)},staticRenderFns:[]};var g=i("VU/8")(u,f,!1,function(t){i("gLck")},null,null);e.default=g.exports},gLck:function(t,e){},jd4r:function(t,e,i){t.exports=i.p+"static/img/addimg.0d12f6a.png"}});
//# sourceMappingURL=10.923d098ebc8675533f22.js.map