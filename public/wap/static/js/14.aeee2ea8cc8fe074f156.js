webpackJsonp([14],{FmEr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a={data:function(){return{order_id:this.$route.query.order_id||0,images:[],score:[],goodsList:[],textarea:[],isupload:[]}},created:function(){var t=this;if(!this.order_id)return this.$dialog.alert({mes:"该订单不存在",callback:function(){t.$router.go(-1)}}),!1;this.$api.orderDetail({order_id:this.order_id},function(e){if("pending_evaluate"!==e.data.text_status)return t.$dialog.alert({mes:"该订单状态有误暂不可评价",callback:function(){t.$router.go(-1)}}),!1;t.goodsList=e.data.items;var i=[],a=[],s=[],r=[];for(var o in t.goodsList){var d=t.goodsList[o].id;i[d]=[],s[d]=5,a[d]="",r[d]=!0}t.images=i,t.textarea=a,t.score=s,t.isupload=r})},methods:{update:function(t,e){var i=this,a=e.target.files[0],s=new FormData;s.append("upfile",a,a.name),this.$api.uploadFile("image",s,function(e){if(e.status){var a={url:e.data.url,id:e.data.image_id};i.images[t].push(a)}})},remove:function(t,e){this.images[t].splice(e,1)},sendEvaluate:function(){var t=this,e={order_id:this.order_id,items:{}};for(var i in this.images)e.items[i]={images:this.images[i],score:this.score[i],textarea:this.textarea[i]};this.$api.orderEvaluate(e,function(e){e.status&&(t.$dialog.toast({mes:e.msg,timeout:1e3,icon:"success"}),setTimeout(function(){t.$router.go(-1)},1e3))})}},watch:{images:function(){for(var t in this.images)this.images[t].length>=4?this.isupload[t]=!1:this.isupload[t]=!0}}},s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"evaluate"},[t._l(t.goodsList,function(e,s){return t.goodsList.length?a("div",{key:s},[a("div",{staticClass:"evaluateheader"},[a("div",{staticClass:"evaluateheader-top"},[a("img",{staticClass:"goods-img",attrs:{src:e.image_url}}),t._v(" "),a("yd-cell-item",[a("yd-rate",{attrs:{slot:"right",size:"20px"},slot:"right",model:{value:t.score[e.id],callback:function(i){t.$set(t.score,e.id,i)},expression:"score[item.id]"}})],1)],1)]),t._v(" "),a("div",{staticClass:"evaluatebody"},[a("yd-cell-item",[a("yd-textarea",{attrs:{slot:"right",placeholder:"宝贝满足你的期望吗？说说它的优点和美中不足的地方吧",maxlength:"200"},slot:"right",model:{value:t.textarea[e.id],callback:function(i){t.$set(t.textarea,e.id,i)},expression:"textarea[item.id]"}})],1),t._v(" "),t.images[e.id].length?a("div",{staticClass:"uploadimg-list"},t._l(t.images[e.id],function(i,s){return a("div",{key:s},[a("yd-badge",{nativeOn:{click:function(i){t.remove(e.id,s)}}},[t._v("X")]),t._v(" "),a("img",{staticClass:"thumbnail-list",attrs:{src:i.url}})],1)})):t._e(),t._v(" "),a("div",{staticClass:"evaluatebody-img"},[a("div",{staticClass:"uploadimg"},[a("input",{attrs:{name:"file",type:"file",accept:"image/png,image/gif,image/jpeg"},on:{change:function(i){t.update(e.id,i)}}}),t._v(" "),a("img",{directives:[{name:"show",rawName:"v-show",value:t.isupload[e.id],expression:"isupload[item.id]"}],attrs:{slot:"icon",src:i("jd4r")},slot:"icon"})])])],1)]):t._e()}),t._v(" "),a("yd-button-group",[a("yd-button",{attrs:{size:"large",bgcolor:"#ff3b44",color:"#fff"},nativeOn:{click:function(e){return t.sendEvaluate(e)}}},[t._v("提交评价")])],1)],2)},staticRenderFns:[]};var r=i("VU/8")(a,s,!1,function(t){i("ktjE")},null,null);e.default=r.exports},jd4r:function(t,e,i){t.exports=i.p+"static/img/addimg.0d12f6a.png"},ktjE:function(t,e){}});
//# sourceMappingURL=14.aeee2ea8cc8fe074f156.js.map